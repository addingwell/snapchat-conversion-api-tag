___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Snapchat Conversion API by Addingwell",
  "brand": {
    "id": "brand_dummy",
    "displayName": "Addingwell",
    "thumbnail": "data:image/jpeg;base64,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\u003d\u003d"
  },
  "description": "The Snapchat Conversion API template reads data from the GA4 client and sends it (mapped) to Snapchat Conversion API.",
  "containerContexts": [
    "SERVER"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "LABEL",
    "name": "documentation",
    "displayName": "This tag translates standard GA4 event data into Snapchat event formats and sends it to the Snapchat Conversion API. For detailed setup instructions, please refer to the \u003ca href\u003d\"https://docs.addingwell.com/en/snapchat-capi/tag-setup\"\u003eAddingwell documentation\u003c/a\u003e.\u003cbr\u003e\u003cbr\u003e"
  },
  {
    "type": "SELECT",
    "name": "inheritEventName",
    "displayName": "Event Name Setup Method",
    "macrosInSelect": false,
    "selectItems": [
      {
        "value": "inherit",
        "displayValue": "Inherit from client"
      },
      {
        "value": "override",
        "displayValue": "Override"
      }
    ],
    "simpleValueType": true,
    "subParams": [
      {
        "type": "RADIO",
        "name": "eventName",
        "displayName": "Event Type",
        "radioItems": [
          {
            "value": "standard",
            "displayValue": "Standard",
            "subParams": [
              {
                "type": "SELECT",
                "name": "eventNameStandard",
                "selectItems": [
                  {
                    "value": "PAGE_VIEW",
                    "displayValue": "PAGE_VIEW"
                  },
                  {
                    "value": "LIST_VIEW",
                    "displayValue": "LIST_VIEW"
                  },
                  {
                    "value": "VIEW_CONTENT",
                    "displayValue": "VIEW_CONTENT"
                  },
                  {
                    "value": "ADD_CART",
                    "displayValue": "ADD_CART"
                  },
                  {
                    "value": "ADD_TO_WISHLIST",
                    "displayValue": "ADD_TO_WISHLIST"
                  },
                  {
                    "value": "SIGN_UP",
                    "displayValue": "SIGN_UP"
                  },
                  {
                    "value": "SEARCH",
                    "displayValue": "SEARCH"
                  },
                  {
                    "value": "COMPLETE_TUTORIAL",
                    "displayValue": "COMPLETE_TUTORIAL"
                  },
                  {
                    "value": "START_CHECKOUT",
                    "displayValue": "START_CHECKOUT"
                  },
                  {
                    "value": "ADD_BILLING",
                    "displayValue": "ADD_BILLING"
                  },
                  {
                    "value": "PURCHASE",
                    "displayValue": "PURCHASE"
                  },
                  {
                    "value": "SAVE",
                    "displayValue": "SAVE"
                  },
                  {
                    "value": "SUBSCRIBE",
                    "displayValue": "SUBSCRIBE"
                  },
                  {
                    "value": "AD_CLICK",
                    "displayValue": "AD_CLICK"
                  },
                  {
                    "value": "AD_VIEW",
                    "displayValue": "AD_VIEW"
                  },
                  {
                    "value": "LEVEL_COMPLETE",
                    "displayValue": "LEVEL_COMPLETE"
                  },
                  {
                    "value": "INVITE",
                    "displayValue": "INVITE"
                  },
                  {
                    "value": "LOGIN",
                    "displayValue": "LOGIN"
                  },
                  {
                    "value": "SHARE",
                    "displayValue": "SHARE"
                  },
                  {
                    "value": "RESERVE",
                    "displayValue": "RESERVE"
                  },
                  {
                    "value": "ACHIEVEMENT_UNLOCKED",
                    "displayValue": "ACHIEVEMENT_UNLOCKED"
                  },
                  {
                    "value": "SPENT_CREDITS",
                    "displayValue": "SPENT_CREDITS"
                  },
                  {
                    "value": "RATE",
                    "displayValue": "RATE"
                  },
                  {
                    "value": "START_TRIAL",
                    "displayValue": "START_TRIAL"
                  },
                  {
                    "value": "APP_INSTALL",
                    "displayValue": "APP_INSTALL"
                  },
                  {
                    "value": "APP_OPEN",
                    "displayValue": "APP_OPEN"
                  }
                ],
                "simpleValueType": true
              }
            ]
          },
          {
            "value": "custom",
            "displayValue": "Custom",
            "subParams": [
              {
                "type": "SELECT",
                "name": "eventNameCustom",
                "selectItems": [
                  {
                    "value": "CUSTOM_EVENT_1",
                    "displayValue": "CUSTOM_EVENT_1"
                  },
                  {
                    "value": "CUSTOM_EVENT_2",
                    "displayValue": "CUSTOM_EVENT_2"
                  },
                  {
                    "value": "CUSTOM_EVENT_3",
                    "displayValue": "CUSTOM_EVENT_3"
                  },
                  {
                    "value": "CUSTOM_EVENT_4",
                    "displayValue": "CUSTOM_EVENT_4"
                  },
                  {
                    "value": "CUSTOM_EVENT_5",
                    "displayValue": "CUSTOM_EVENT_5"
                  }
                ],
                "simpleValueType": true
              }
            ]
          }
        ],
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "inheritEventName",
            "paramValue": "override",
            "type": "EQUALS"
          }
        ]
      }
    ],
    "defaultValue": "inherit",
    "help": "2 options: \u003cul\u003e\u003cli\u003e\u003cb\u003eInherit from client\u003c/b\u003e: automatic mapping between GA4 event names and Snapchat standard events.\u003c/li\u003e \u003cli\u003e\u003cb\u003eOverride\u003c/b\u003e: manually set which event you want to send to Snapchat whatever the GA4 event name is.\u003c/li\u003e \u003c/ul\u003e \u003ca href\u003d\"https://docs.addingwell.com/en/snapchat-capi/tag-setup\"\u003eLearn more\u003c/a\u003e"
  },
  {
    "type": "TEXT",
    "name": "accessToken",
    "displayName": "Access Token",
    "simpleValueType": true,
    "help": "Snapchat Conversion API access token is available in Snapchat Business Manager. \u003ca href\u003d\"https://docs.addingwell.com/en/snapchat-capi/find-snapchat-conversion-api-access-token\"\u003eLearn more\u003c/a\u003e",
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "valueHint": "eyJhbGciOiJIUzI1NiIsImtpZCI6IkNh"
  },
  {
    "type": "TEXT",
    "name": "pixelId",
    "displayName": "Pixel ID",
    "simpleValueType": true,
    "help": "Snapchat Pixel ID is available in Snapchat Events Manager. \u003ca href\u003d\"https://docs.addingwell.com/en/snapchat-capi/find-snap-pixel-id\"\u003eLearn more\u003c/a\u003e",
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "valueHint": "b17824d6-bdd6-57f9-6e7a-571cdcd6633b"
  },
  {
    "type": "CHECKBOX",
    "name": "testEvents",
    "checkboxText": "Test Events",
    "simpleValueType": true,
    "help": "If you check this checkbox, the tag will add \u003cb\u003e/validate\u003c/b\u003e to every event request so that the events appear in Snapchat \u003cb\u003eTest Events\u003c/b\u003e section in the \u003cb\u003eEvents Manager\u003c/b\u003e. \u003ca href\u003d\"https://businesshelp.snapchat.com/s/article/capi-event-testing\"\u003eLearn more\u003c/a\u003e"
  },
  {
    "type": "GROUP",
    "name": "serverEventDataListGroup",
    "displayName": "Server Event Data Override",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "SIMPLE_TABLE",
        "name": "serverEventDataList",
        "simpleTableColumns": [
          {
            "defaultValue": "action_source",
            "displayName": "Property Name",
            "name": "name",
            "type": "SELECT",
            "selectItems": [
              {
                "value": "action_source",
                "displayValue": "Action Source"
              },
              {
                "value": "event_time",
                "displayValue": "Event Time"
              },
              {
                "value": "event_source_url",
                "displayValue": "Event Source URL"
              },
              {
                "value": "event_id",
                "displayValue": "Event ID"
              }
            ]
          },
          {
            "defaultValue": "",
            "displayName": "Property Value",
            "name": "value",
            "type": "TEXT",
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ]
          }
        ],
        "newRowButtonText": "Add Property",
        "displayName": "Server event data",
        "help": "List of server event data:\n\u003cul\u003e\n\t\u003cli\u003e\u003cb\u003eAction Source\u003c/b\u003e: Where the event took place. Required for all web and app events. Use the appropriate value accordingly.\n\t\t\u003cul\u003e\n\t\t\t\u003cli\u003e\u003cb\u003eWEB\u003c/b\u003e: From a website.\u003c/li\u003e\n\t\t\t\u003cli\u003e\u003cb\u003eMOBILE_APP\u003c/b\u003e: From a mobile app.\u003c/li\u003e\n\t\t\t\u003cli\u003e\u003cb\u003eOFFLINE\u003c/b\u003e: From a physical store.\u003c/li\u003e\n\t\t\u003c/ul\u003e\n\t\t(default: \u003cb\u003eWEB\u003c/b\u003e)\n\t\u003c/li\u003e\n\t\u003cli\u003e\u003cb\u003eEvent Time\u003c/b\u003e: The Epoch timestamp for the conversion happening. We can handle second level or millisecond level granularity. However, we do encourage requests to provide millisecond level granularity. (default: getTimestampMillis())\u003c/li\u003e\n\t\u003cli\u003e\u003cb\u003eEvent Source URL\u003c/b\u003e: The URL of the web page where the event took place. Must include protocol (eg http, https). (default: eventData.page_location)\u003c/li\u003e\n\t\u003cli\u003e\u003cb\u003eEvent ID\u003c/b\u003e: This field represents a unique identifier chosen by the advertiser to represent an event. (default: eventData.event_id)\u003c/li\u003e\n\u003c/ul\u003e \u003ca href\u003d\"https://developers.snap.com/api/marketing-api/Conversions-API/Parameters#server-parameters\"\u003eLearn more\u003c/a\u003e"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "userDataListGroup",
    "displayName": "User Data Override",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "SIMPLE_TABLE",
        "name": "userDataList",
        "displayName": "User data",
        "simpleTableColumns": [
          {
            "defaultValue": "em",
            "displayName": "Property Name",
            "name": "name",
            "type": "SELECT",
            "selectItems": [
              {
                "value": "em",
                "displayValue": "Email"
              },
              {
                "value": "ph",
                "displayValue": "Phone Number"
              },
              {
                "value": "fn",
                "displayValue": "First Name"
              },
              {
                "value": "ln",
                "displayValue": "Last Name"
              },
              {
                "value": "ge",
                "displayValue": "Gender"
              },
              {
                "value": "ct",
                "displayValue": "City"
              },
              {
                "value": "st",
                "displayValue": "State"
              },
              {
                "value": "zp",
                "displayValue": "Postal Code"
              },
              {
                "value": "country",
                "displayValue": "Country"
              },
              {
                "value": "client_ip_address",
                "displayValue": "Client IP Address"
              },
              {
                "value": "external_id",
                "displayValue": "External ID"
              },
              {
                "value": "subscription_id",
                "displayValue": "Subscription ID"
              },
              {
                "value": "lead_id",
                "displayValue": "Lead ID"
              }
            ],
            "isUnique": true
          },
          {
            "defaultValue": "",
            "displayName": "Property Value",
            "name": "value",
            "type": "TEXT",
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ]
          }
        ],
        "newRowButtonText": "Add property",
        "help": "List of user data (If you send it hashed the tag will forward it, if you send it plain the tag will hash it (if required) before sending it to Snapchat Conversion API) :\n\u003cul\u003e\n\t\u003cli\u003e\u003cb\u003eEmail\u003c/b\u003e: (default: eventData.user_data.email_address or eventData.user_data.email) \u003c/li\u003e\n\t\u003cli\u003e\u003cb\u003ePhone Number\u003c/b\u003e: (default: eventData.user_data.phone_number)\u003c/li\u003e\n\t\u003cli\u003e\u003cb\u003eFirst Name\u003c/b\u003e: (default: eventData.user_data.address.first_name or eventData.user_data.address.0.first_name)\u003c/li\u003e\n\t\u003cli\u003e\u003cb\u003eLast Name\u003c/b\u003e: (default: eventData.user_data.address.last_name or eventData.user_data.address.0.last_name)\u003c/li\u003e\n\t\u003cli\u003e\u003cb\u003eGender\u003c/b\u003e: \u003cb\u003ef\u003c/b\u003e for female and \u003cb\u003em\u003c/b\u003e for male. (default: eventData.user_data.gender)\u003c/li\u003e\n\t\u003cli\u003e\u003cb\u003eCity\u003c/b\u003e: City associated with the conversion. (default: eventData.user_data.address.city or eventData.user_data.address.0.city)\u003c/li\u003e\n\t\u003cli\u003e\u003cb\u003eState\u003c/b\u003e: State associated with the conversion. (default: eventData.user_data.address.state or eventData.user_data.address.0.state)\u003c/li\u003e\n\t\u003cli\u003e\u003cb\u003ePostal Code\u003c/b\u003e: Zip or postal code. (default: eventData.user_data.address.postal_code or eventData.user_data.address.0.postal_code)\u003c/li\u003e\n\t\u003cli\u003e\u003cb\u003eCountry\u003c/b\u003e: Country associated with the event. (default: eventData.user_data.address.country or eventData.user_data.address.0.country)\u003c/li\u003e\n\t\u003cli\u003e\u003cb\u003eClient IP Address\u003c/b\u003e: IP Address of the device (not server). (default: eventData.ip_override or headers.x-forwared-for or headers.forwarded)\u003c/li\u003e\n\t\u003cli\u003e\u003cb\u003eExternal ID\u003c/b\u003e: A unique ID such as a loyalty card ID, first party cookie identifier, or some other identifier. (default: eventData.user_id)\u003c/li\u003e\n\t\u003cli\u003e\u003cb\u003eSubscription ID\u003c/b\u003e: The subscription ID for the user who generated this event. (No default)\u003c/li\u003e\n\t\u003cli\u003e\u003cb\u003eLead ID\u003c/b\u003e: This is the identifier associated with your Snapchat Lead Ad (No default)\u003c/li\u003e\n\u003c/ul\u003e \u003ca href\u003d\"https://developers.snap.com/api/marketing-api/Conversions-API/Parameters#user-data-parameters\"\u003eLearn more\u003c/a\u003e"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "customDataListGroup",
    "displayName": "Custom Data Override",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "SIMPLE_TABLE",
        "name": "customDataList",
        "simpleTableColumns": [
          {
            "defaultValue": "",
            "displayName": "Property Name",
            "name": "name",
            "type": "TEXT",
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ]
          },
          {
            "defaultValue": "",
            "displayName": "Property Value",
            "name": "value",
            "type": "TEXT",
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ]
          }
        ],
        "newRowButtonText": "Add Property",
        "displayName": "Custom data",
        "help": "List of custom data parameters (you can also add other parameters which will be sent through \u003ci\u003ecustom_data.custom_fields\u003c/i\u003e):\n\u003cul\u003e\n  \u003cli\u003e\u003cb\u003econtent_category\u003c/b\u003e: Item or Category. Can be a single category or an array. (default: eventData.items.0.item_category)\u003c/li\u003e\n  \u003cli\u003e\u003cb\u003econtents\u003c/b\u003e: This field represents item purchases in the form of a list of JSON objects. (default: fields in eventData.items)\u003c/li\u003e\n  \u003cli\u003e\u003cb\u003econtent_ids\u003c/b\u003e: e.g. [\"sku001”,”sku002”,”sku003\"] (default: eventData.items.X.item_id)\u003c/li\u003e\n  \u003cli\u003e\u003cb\u003econtent_type\u003c/b\u003e : Choose \"product\" for individual items or \"product_group\" for items that have multiple options in either size, color or any other variation. (No default)\u003c/li\u003e\n  \u003cli\u003e\u003cb\u003ecurrency\u003c/b\u003e: This represents the currency associated with the value provided. (default: eventData.currency)\u003c/li\u003e\n  \u003cli\u003e\u003cb\u003enum_items\u003c/b\u003e: This indicates the total number of items (default: eventData.items.length)\u003c/li\u003e\n  \u003cli\u003e\u003cb\u003eorder_id\u003c/b\u003e: This is the id representative of the order (default: eventData.transaction_id)\u003c/li\u003e\n  \u003cli\u003e\u003cb\u003epredicted_ltv\u003c/b\u003e: This is the predicted lifetime value of a conversion event (default: eventData.customer_lifetime_value)\u003c/li\u003e\n  \u003cli\u003e\u003cb\u003evalue\u003c/b\u003e: This numeric value is associated with the specific event. (default: eventData.value)\u003c/li\u003e\n  \u003cli\u003e\u003cb\u003esearch_string\u003c/b\u003e: The text that was searched for (default: eventData.search_term)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ca href\u003d\"https://developers.snap.com/api/marketing-api/Conversions-API/Parameters#custom-data-parameters\"\u003eGet full list here\u003c/a\u003e"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "itemDataListGroup",
    "displayName": "Items Data Override",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "SIMPLE_TABLE",
        "name": "itemDataList",
        "displayName": "Update default item field",
        "simpleTableColumns": [
          {
            "defaultValue": "item_id",
            "displayName": "Property Name",
            "name": "name",
            "type": "SELECT",
            "selectItems": [
              {
                "value": "item_id",
                "displayValue": "item_id"
              },
              {
                "value": "quantity",
                "displayValue": "quantity"
              },
              {
                "value": "price",
                "displayValue": "price"
              },
              {
                "value": "item_category",
                "displayValue": "item_category"
              },
              {
                "value": "item_name",
                "displayValue": "item_name"
              },
              {
                "value": "item_brand",
                "displayValue": "item_brand"
              }
            ],
            "isUnique": true
          },
          {
            "defaultValue": "",
            "displayName": "Property Field",
            "name": "field",
            "type": "TEXT",
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ]
          }
        ],
        "newRowButtonText": "Add Property",
        "help": "Override the field name this tag will look for in the GA4 \u003cb\u003eeventData.items\u003c/b\u003e array. (e.g. if Property Name \u003d \u003ci\u003eitem_id\u003c/i\u003e and Property Field \u003d \u003ci\u003eitem_variant_id\u003c/i\u003e the tag will use \u003ci\u003eitem_variant_id\u003c/i\u003e as item ID to fill \u003cb\u003econtents\u003c/b\u003e and \u003cb\u003econtent_ids\u003c/b\u003e arrays)"
      }
    ]
  }
]


___SANDBOXED_JS_FOR_SERVER___

const log = require('logToConsole');
const sendHttpRequest = require('sendHttpRequest');
const JSON = require('JSON');
const Math = require('Math');
const getTimestampMillis = require('getTimestampMillis');
const getAllEventData = require('getAllEventData');
const eventData = getAllEventData();
const getRemoteAddress = require('getRemoteAddress');
const encodeUriComponent = require('encodeUriComponent');
const encodeUri = require('encodeUri');
const createRegex = require('createRegex');
const getCookieValues = require('getCookieValues');
const sha256Sync = require('sha256Sync');
const parseUrl = require('parseUrl');
const setCookie = require('setCookie');
const getType = require('getType');
const generateRandom = require('generateRandom');
const makeNumber = require('makeNumber');
const browserId = getBrowserId();
const makeString = require('makeString');
const api_version = 'v3';
const events_api_url = 'https://tr.snapchat.com/' + encodeUri(api_version) + '/' + encodeUri(data.pixelId) + '/events' + (data.testEvents ? '/validate' : '') + '?access_token=' + encodeUriComponent(data.accessToken);

const ga4SnapchatEventMapping = {
    'page_view': 'PAGE_VIEW',
    'view_item_list': 'LIST_VIEW',
    'view_item': 'VIEW_CONTENT',
    'sign_up': 'SIGN_UP',
    'add_to_wishlist': 'ADD_TO_WISHLIST',
    'add_to_cart': 'ADD_CART',
    'begin_checkout':	'START_CHECKOUT',
    'add_payment_info': 'ADD_BILLING',
    'purchase': 'PURCHASE',
    'tutorial_complete': 'COMPLETE_TUTORIAL',
    'search': 'SEARCH',
    'login': 'LOGIN',
    'level_end': 'LEVEL_COMPLETE',
    'share': 'SHARE',
    'view_promotion': 'AD_VIEW',
    'generate_lead': 'SIGN_UP'
  };

var body = {
  data: [{
      integration: "addingwell-sgtm-tag",
      event_name: getSnapchatEventName(),
      event_time: getTimestampMillis(),
      event_id: eventData.event_id,
      action_source: "WEB",
      event_source_url: eventData.page_location,
      user_data: getUserDataParameters(),
      custom_data: getCustomDataParameters()
  }]
};

if (data.serverEventDataList) {
  data.serverEventDataList.forEach(d => {
    body.data[0][d.name] = d.value;
  });
}

if(parseUrl(eventData.page_location).searchParams.ScClid || getUserDataParameters().sc_click_id) {
  setCookie(
    '_scclid',
    (parseUrl(eventData.page_location).searchParams.ScClid || getUserDataParameters().sc_click_id), 
    {
      domain: 'auto',
      path: '/',
      samesite: 'Lax',
      secure: true,
      'max-age': 7776000,
      httpOnly: false
    }
  );
}

if(getUserDataParameters().sc_cookie1) {
  setCookie(
    '_scid',
    getUserDataParameters().sc_cookie1,
    {
      domain: 'auto',
      path: '/',
      samesite: 'Lax',
      secure: true,
      'max-age': 7776000,
      httpOnly: false
    }
  );
}

sendHttpRequest(
  events_api_url,
  (statusCode, headers, body) => {
    log(body);
    if (statusCode >= 200 && statusCode < 400) {
        data.gtmOnSuccess();
      } else {
        data.gtmOnFailure();
      }
  },
  {
    method: 'POST'
  },
  JSON.stringify(body)
);

log(body);

function getSnapchatEventName(gtmEventName) {
  if (data.inheritEventName === 'inherit') {
    return ga4SnapchatEventMapping[eventData.event_name];
  }

  return data.eventName === 'standard' ? data.eventNameStandard : data.eventNameCustom;
}

function getUserDataParameters() {
  
  let user_data = {};
  let address = {};
  
  if (getType(eventData.user_data) === 'object') {
    user_data = eventData.user_data;
    const addressType = getType(user_data.address);
    if (addressType === 'object' || addressType === 'array') {
      address = user_data.address[0] || user_data.address;
    }
  }

  let sc_user_data = {
    em: undefined,
    pn: undefined,
    fn: undefined,
    ln: undefined,
    ge: undefined,
    ct: undefined,
    st: undefined,
    zp: undefined,
    country: undefined,
    client_ip_address: eventData.ip_override || getRemoteAddress(),
    external_id: hashData(eventData.user_id),
    client_user_agent: eventData.user_agent,
    sc_click_id: getClickId(),
    sc_cookie1: browserId,
    subscription_id: undefined,
    lead_id: undefined
  };
  
  
  if(user_data) {
    if(user_data.gender) {
      sc_user_data.ge = hashData(user_data.gender);    
    } else if (user_data.sha256_gender) {
      sc_user_data.ge = hashData(user_data.sha256_gender);
    }
    
    if(user_data.email_address) {
      sc_user_data.em = hashData(user_data.email_address);
    } else if(user_data.email) {
      sc_user_data.em = hashData(user_data.email);
    } else if(user_data.sha256_email_address) {
      sc_user_data.em = hashData(user_data.sha256_email_address);
    }
    
    if(user_data.phone_number) { 
      sc_user_data.pn = hashData(makeString(user_data.phone_number).replace(createRegex('[+ ]+', 'g'), ''));
    } else if(user_data.sha256_phone_number) {
      sc_user_data.pn = hashData(user_data.sha256_phone_number);
    }
    
    if(getType(address) == 'object') {
      
      if(address.first_name) {
        sc_user_data.fn = hashData(address.first_name);
      } else if(address.sha256_first_name) {
        sc_user_data.fn = hashData(address.sha256_first_name);
      }
      
      if(address.last_name) {
        sc_user_data.ln = hashData(address.last_name);
      } else if(address.sha256_last_name) {
        sc_user_data.ln = hashData(address.sha256_last_name);
      }

      if(address.city) {
        sc_user_data.ct = hashData(address.city);
      } else if(address.sha256_city) {
        sc_user_data.ct = hashData(address.sha256_city);
      }
      
      if(address.postal_code) {
        sc_user_data.zp = hashData(address.postal_code);
      } else if(address.sha256_postal_code) {
        sc_user_data.zp = hashData(address.sha256_postal_code);
      }
      
      if(address.country) {
        sc_user_data.country = hashData(address.country);
      } else if(address.sha256_country) {
        sc_user_data.country = hashData(address.sha256_country);
      }
      
      if(address.state) {
        sc_user_data.st = hashData(address.state);
      } else if(address.sha256_state) {
        sc_user_data.st = hashData(address.sha256_state);
      }
      
    }
    
  }
  
  if(getType(address) == 'array') {
    
    if(address[0].first_name) {
        sc_user_data.fn = hashData(address[0].first_name);
    }
    
    if(address[0].last_name) {
       sc_user_data.ln = hashData(address[0].last_name);
    }
    
    if(address[0].city != undefined) {
        sc_user_data.ct = hashData(address[0].city);
    }
    
    if(address[0].postal_code) {
        sc_user_data.zp = hashData(address[0].postal_code);
    }
    
    if(address[0].state) {
        sc_user_data.st = hashData(address[0].state);
    }
    
    if(address[0].country) {
        sc_user_data.country = hashData(address[0].country);
     }
    
  }
  
  if (data.userDataList) {
    data.userDataList.forEach(d => {
      if(d.name == "pn") {
        sc_user_data[d.name] = hashData(d.value.replace(createRegex('[+ ]+', 'g'), ''));
      } else {
        sc_user_data[d.name] = hashData(d.value);             
      }
    });
  }
  
  if(JSON.stringify(sc_user_data) === "{}") { return undefined; }
  
  return sc_user_data;
}

function getContents() {

  var contents;
  
  if(eventData.items) {
    contents = [];
    eventData.items.forEach((item) => {
      contents.push({
        price: item[getItemField('price')],
        quantity: item[getItemField('quantity')],
        content_id: item[getItemField('item_id')],
        content_category: item[getItemField('item_category')],
        content_name: item[getItemField('item_name')],
        brand: item[getItemField('item_brand')]
      });
    });
  }
  
  return contents;
}

function getContentIds() {

  var content_ids;
  
  if(eventData.items) {
    content_ids = [];
    eventData.items.forEach((item) => {
      content_ids.push(item[getItemField('item_id')]);

    });
  }
  
  return content_ids;
}

function getItemsCategories() {
  var items_categories;
  
  if(eventData.items) {
    items_categories = [];
    eventData.items.forEach((item) => {
      if(item[getItemField('item_category')] && items_categories.indexOf(item[getItemField('item_category')]) === -1) {
        items_categories.push(item[getItemField('item_category')]);
      }
    });
  }
  
  return items_categories;
}

function getItemField(defaultField) {
  let result = defaultField;

  const map = {
    item_id: 'item_id',
    price: 'price',
    quantity: 'quantity',
    item_category: 'item_category',
    item_name: 'item_name',
    item_brand: 'item_brand'
  };

  if (data.itemDataList) {
    data.itemDataList.forEach(d => {
      if (map[defaultField] === d.name) {
        result = d.field;
      }
    });
  }

  return result;
}

function getCustomDataParameters(){
  
  let custom_data = {
     
    //Dynamic Ads Parameters 
    content_category: getItemsCategories(),
    contents: getContents(),
    content_ids: getContentIds(),
    content_type: undefined,
    currency: eventData.currency,
    num_items: eventData.items ? eventData.items.length : undefined,
    order_id: eventData.transaction_id,
    predicted_ltv: eventData.customer_lifetime_value ? makeNumber(eventData.customer_lifetime_value) : undefined,
    value: eventData.value ? makeNumber(eventData.value) : undefined,
    search_string: eventData.search_term,
    
    //Dynamic Travel Ads Parameters
    checkin_date: eventData.checkin_date,
    travel_end: eventData.travel_end,
    travel_start: eventData.travel_start,
    suggested_destinations: eventData.suggested_destinations,
    destination_airport: eventData.destination_airport,
    country: eventData.country,
    city: eventData.city,
    region: eventData.region,
    neighborhood: eventData.neighborhood,
    departing_departure_date: eventData.departing_departure_date,
    departing_arrival_date: eventData.departing_arrival_date,
    num_adults: eventData.num_adults,
    origin_airport: eventData.origin_airport,
    returning_departure_date: eventData.returning_departure_date,
    returning_arrival_date: eventData.returning_arrival_date,
    num_children: eventData.num_children,
    hotel_score: eventData.hotel_score,
    postal_code: eventData.postal_code,
    num_infants: eventData.num_infants,
    preferred_neighborhoods: eventData.preferred_neighborhoods,
    preferred_star_ratings: eventData.preferred_star_ratings,
    suggested_hotels: eventData.suggested_hotels,
    destination_ids: eventData.destination_ids,
    
    //Other
    status: getStatus(),
    event_tag: eventData.event_tag
  };
  
  if (data.customDataList) {
    data.customDataList.forEach(d => {
      if(custom_data[d.name]) {
        custom_data[d.name] = d.value;
      } else {
        if(custom_data.custom_fields) {
          custom_data.custom_fields[d.name] = d.value;
        } else {
          custom_data.custom_fields = {};
          custom_data.custom_fields[d.name] = d.value;
        }
        
      }
    });
  }
  
  if(JSON.stringify(custom_data) === "{}") { return undefined; }
  
  return custom_data;
  
}

function getStatus() {
  let status;
  
  if(eventData.new_customer) {
    if(eventData.new_customer == "true") {
      status = "new";  
    } else {
      status = "returning";
    }
  }
  
  return status;
}

function getClickId() {
  return parseUrl(eventData.page_location).searchParams.ScCid || getCookieValues('_scclid')[0] || eventData._scclid || eventData.scclid;
}

function getBrowserId() {
  return getCookieValues('_scid')[0] || eventData.scid || eventData._scid || generateUUID();
}

function generateUUID() {
  let len = 36;
  let chars = '0123456789abcdef'.split('');
  let uuid = '';

  for (var i = 0; i < len; i++) {
    if (i == 8 || i == 13 || i == 18 || i == 23) {
      uuid += '-';
    } else if (i == 14) {
      uuid += '4';
    } else {
      uuid += chars[generateRandom(0, chars.length - 1)];
    }
  }
  return uuid;
}

function isAlreadyHashed(input){
  return input && (input.toString().match('^[A-Fa-f0-9]{64}$') != null);
}

function hashData(input){
  if(input == null || isAlreadyHashed(input)){
    return input;
  }

  return sha256Sync(input.toString().trim().toLowerCase(), {outputEncoding: 'hex'});
}


___SERVER_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "read_request",
        "versionId": "1"
      },
      "param": [
        {
          "key": "requestAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "headerAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queryParameterAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_event_data",
        "versionId": "1"
      },
      "param": [
        {
          "key": "eventDataAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "send_http",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedUrls",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "cookieAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "cookieNames",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "_scid"
              },
              {
                "type": 1,
                "string": "_scclid"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "set_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedCookies",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "_scid"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "_scclid"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 22/08/2024, 15:53:36


